- name: Download and unzip latest version of Raspbian OS Lite into rpiz_cams_os
  unarchive:
    src: https://downloads.raspberrypi.org/raspios_lite_armhf/images/raspios_lite_armhf-2021-05-28/2021-05-07-raspios-buster-armhf-lite.zip
    dest: rpiz_os_zip_dest
    mode: '0664'

- name: Activate SSH
  shell: sudo touch ./{{ rpiz_os_dest }}/boot/ ssh

- name: Change MAC address settings to have the same ones
  shell: sudo echo 'options g_cdc host_addr={{ dc:a6:32:69:69:69 }}' > {{ rpiz_os_dest }}/etc/modprobe.d/g_cdc.conf 

dc:a6:32:60:60:95

- name: Find MAC Address
  debug:
    msg: "interface {{ item }}'s MAC is {{ ansible_facts[item]['macaddress']|default(None) }}"
    
    

#- name: Update apt cache and install required GS packages
#  apt:
#    update_cache: true
#    pkg: {{ gs_pkgs }}
#
#  shell: sudo arp-scan {{ lan_address }} | grep dc:a6:32
#
#- name: Get list of rpiz_cams IP addresses
#  command: ...
#  register: ....

# Run another task on the raspberry pi's to change all the network settings to what we need them to be

# Run rpiz_cams tasks on all pi's

 
